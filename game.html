<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WalzShop - Detail Game</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header class="header">
  <img src="https://files.catbox.moe/dpsks9.jpg" alt="Logo WalzShop" class="logo">
  <h1>WalzShop</h1>
</header>

<main class="container">
  <button id="backBtn" class="btn-back">‚Üê Kembali</button>

  <div class="game-detail">
    <img id="gameImage" src="" alt="Game Image" class="game-img">
    <h2 id="gameName" class="game-title"></h2>
  </div>

  <div class="checkout-form">
    <label>ID / Nickname</label>
    <input type="text" id="playerId" placeholder="Masukkan ID / Nickname">

    <label>Paket Diamond</label>
    <div class="diamond-grid" id="diamondGrid"></div>

    <label>Metode Pembayaran</label>
    <div class="payment-grid" id="paymentGrid"></div>

    <label>Kode Voucher (Opsional)</label>
    <input type="text" id="voucher" placeholder="Masukkan kode voucher">

    <button id="checkoutBtn" class="btn-checkout">Checkout</button>
  </div>
</main>

<div class="popup" id="popup">
  <div class="popup-content">
    <h3>Detail Transaksi</h3>
    <p id="popupText"></p>
    <button id="confirmBtn" class="btn-checkout">Konfirmasi & WhatsApp</button>
  </div>
</div>

<footer>
  <p>¬© 2025 WalzShop. Semua Hak Dilindungi.</p>
</footer>

<script>
const params = new URLSearchParams(window.location.search);
const game = params.get('game') || 'Game';
const img = params.get('img') || '';

const gameName = document.getElementById('gameName');
const gameImage = document.getElementById('gameImage');
const diamondGrid = document.getElementById('diamondGrid');
const paymentGrid = document.getElementById('paymentGrid');
const checkoutBtn = document.getElementById('checkoutBtn');
const popup = document.getElementById('popup');
const popupText = document.getElementById('popupText');
const confirmBtn = document.getElementById('confirmBtn');
const backBtn = document.getElementById('backBtn');

let selectedDiamond = null;
let selectedPayment = null;

gameName.textContent = game;
gameImage.src = img;

// Diamond
const diamonds = [
  {value:50, price:"Rp5.000", market:"Rp6.000", emoji:"üíé"},
  {value:100, price:"Rp10.000", market:"Rp12.000", emoji:"üíé"},
  {value:250, price:"Rp22.000", market:"Rp25.000", emoji:"üíé"},
  {value:500, price:"Rp45.000", market:"Rp50.000", emoji:"üíé"},
  {value:1000, price:"Rp85.000", market:"Rp90.000", emoji:"üíé"},
  {value:2000, price:"Rp160.000", market:"Rp180.000", emoji:"üíé"},
  {value:5000, price:"Rp400.000", market:"Rp450.000", emoji:"üíé"},
  {value:10000, price:"Rp780.000", market:"Rp850.000", emoji:"üíé"}
];

diamonds.forEach(d=>{
  const div = document.createElement('div');
  div.classList.add('diamond-item');
  div.dataset.value=d.value;
  div.dataset.price=d.price;
  div.innerHTML = `<div style="font-size:24px">${d.emoji}</div>
                   <span>${d.value} - ${d.price} (Pasar: ${d.market})</span>`;
  div.addEventListener('click',()=>{
    document.querySelectorAll('.diamond-item').forEach(i=>i.classList.remove('selected'));
    div.classList.add('selected');
    selectedDiamond=d;
  });
  diamondGrid.appendChild(div);
});

// Payment
const payments = [
  {name:"QRIS", img:"https://files.catbox.moe/crlcvj.jpg", fee:"-"},
  {name:"ShopeePay", img:"https://files.catbox.moe/gub7ik.jpg", fee:"Rp0"},
  {name:"Dana", img:"https://files.catbox.moe/vzij14.jpg", fee:"Rp0"},
  {name:"Gopay", img:"https://files.catbox.moe/hjxbgp.jpg", fee:"Rp0"},
  {name:"Ovo", img:"https://files.catbox.moe/uy94ct.jpg", fee:"Rp0"}
];

payments.forEach(p=>{
  const div = document.createElement('div');
  div.classList.add('payment-item');
  div.dataset.value=p.name;
  div.innerHTML = `<img src="${p.img}" alt="${p.name}">
                   <span>${p.name} (${p.fee})</span>`;
  div.addEventListener('click',()=>{
    document.querySelectorAll('.payment-item').forEach(i=>i.classList.remove('selected'));
    div.classList.add('selected');
    selectedPayment=p.name;
  });
  paymentGrid.appendChild(div);
});

// Back button
backBtn.addEventListener('click',()=>window.location.href='index.html');

// Checkout
checkoutBtn.addEventListener('click',()=>{
  const playerId=document.getElementById('playerId').value.trim();
  const voucher=document.getElementById('voucher').value.trim();
  if(!playerId){alert("Masukkan ID / Nickname!"); return;}
  if(!selectedDiamond){alert("Pilih paket diamond!"); return;}
  if(!selectedPayment){alert("Pilih metode pembayaran!"); return;}

  popupText.innerHTML=`Game: <b>${game}</b><br>
                       ID/Nickname: <b>${playerId}</b><br>
                       Diamond: <b>${selectedDiamond.value}</b> - <b>${selectedDiamond.price}</b> (Pasar: ${selectedDiamond.market})<br>
                       Metode: <b>${selectedPayment}</b><br>
                       Voucher: <b>${voucher||'-'}</b>`;
  popup.classList.add('active');
});

// Confirm WhatsApp
confirmBtn.addEventListener('click',()=>{
  const playerId=document.getElementById('playerId').value.trim();
  const voucher=document.getElementById('voucher').value.trim();
  const whatsappNumber='6282298902274';
  const message=encodeURIComponent(`Halo, saya ingin melakukan top up:\nGame: ${game}\nID/Nickname: ${playerId}\nDiamond: ${selectedDiamond.value} - ${selectedDiamond.price} (Pasar: ${selectedDiamond.market})\nMetode: ${selectedPayment}\nVoucher: ${voucher||'-'}`);
  window.open(`https://wa.me/${whatsappNumber}?text=${message}`,'_blank');
});
</script>
</body>
</html>